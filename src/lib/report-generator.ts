interface ReportMetrics {
  afterSales: any;
  kpi: any;
  competitors: any;
  sales: any;
  debt: any;
  tasks: any;
}

export function generateReportContent(
  metrics: ReportMetrics,
  reportType: string,
  config: { title: string; period: string },
  currencySymbol: string
): string {
  const date = new Date().toLocaleDateString();
  
  let reportContent = `ğŸ“Œ ${config.title} â€” AI INSIGHT GENERATED\n\n`;
  reportContent += `âš ï¸ Report Notice:\n`;
  reportContent += `This report is automatically generated using the AI Insight Analytical System, based on real-time operational, financial, and customer data collected across all modules.\n\n`;
  reportContent += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  
  reportContent += `1. REPORT OVERVIEW\n\n`;
  reportContent += `Date: ${date}\n`;
  reportContent += `Generated By: AI Insight System - Pocket CRM\n`;
  reportContent += `Period: ${config.period}\n`;
  reportContent += `Purpose: Provide ${reportType} performance updates, issues, and recommended actions.\n\n`;
  reportContent += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  
  reportContent += `2. EXECUTIVE SUMMARY\n\n`;
  reportContent += `Total Active Items: ${metrics.afterSales.total + metrics.kpi.total + metrics.sales.total + metrics.debt.total + metrics.tasks.total}\n`;
  reportContent += `Overall System Health: ${metrics.kpi.avgProgress.toFixed(1)}%\n`;
  reportContent += `Customer Satisfaction: ${(metrics.afterSales.avgSatisfaction * 20).toFixed(0)}%\n`;
  reportContent += `Task Completion Rate: ${metrics.tasks.completionRate.toFixed(1)}%\n`;
  reportContent += `Collection Rate: ${metrics.debt.collectionRate.toFixed(1)}%\n\n`;
  reportContent += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  
  reportContent += `3. MODULE PERFORMANCE ANALYSIS\n\n`;
  
  reportContent += `3.1 AFTER-SALES FOLLOW-UP\n\n`;
  reportContent += `â€¢ Total Orders: ${metrics.afterSales.total}\n`;
  reportContent += `â€¢ Completed: ${metrics.afterSales.completed} (${((metrics.afterSales.completed/metrics.afterSales.total)*100).toFixed(1)}%)\n`;
  reportContent += `â€¢ In Progress: ${metrics.afterSales.inProgress}\n`;
  reportContent += `â€¢ Pending: ${metrics.afterSales.pending}\n`;
  reportContent += `â€¢ Average Satisfaction: ${metrics.afterSales.avgSatisfaction.toFixed(1)}/5.0\n`;
  reportContent += `â€¢ Total Revenue Tracked: ${currencySymbol}${metrics.afterSales.totalRevenue.toLocaleString()}\n`;
  reportContent += `â€¢ Performance Change: ${metrics.afterSales.change > 0 ? '+' : ''}${metrics.afterSales.change}%\n\n`;
  
  reportContent += `3.2 KPI TRACKING\n\n`;
  reportContent += `â€¢ Total KPIs: ${metrics.kpi.total}\n`;
  reportContent += `â€¢ Achieved: ${metrics.kpi.achieved} âœ…\n`;
  reportContent += `â€¢ On Track: ${metrics.kpi.onTrack} ğŸŸ¡\n`;
  reportContent += `â€¢ At Risk: ${metrics.kpi.atRisk} âš ï¸\n`;
  reportContent += `â€¢ Average Progress: ${metrics.kpi.avgProgress.toFixed(1)}%\n`;
  reportContent += `â€¢ Performance Change: ${metrics.kpi.change > 0 ? '+' : ''}${metrics.kpi.change}%\n\n`;
  
  reportContent += `3.3 COMPETITOR INTELLIGENCE\n\n`;
  reportContent += `â€¢ Total Competitors Tracked: ${metrics.competitors.total}\n`;
  reportContent += `â€¢ Active Monitoring: ${metrics.competitors.tracked}\n`;
  reportContent += `â€¢ High Threats: ${metrics.competitors.threats}\n`;
  reportContent += `â€¢ Market Opportunities: ${metrics.competitors.opportunities}\n`;
  reportContent += `â€¢ Average Competitor Price: ${currencySymbol}${metrics.competitors.avgPrice.toLocaleString()}\n`;
  reportContent += `â€¢ Data Change: ${metrics.competitors.change > 0 ? '+' : ''}${metrics.competitors.change}%\n\n`;
  
  reportContent += `3.4 SALES & MARKETING STRATEGIES\n\n`;
  reportContent += `â€¢ Total Strategies: ${metrics.sales.total}\n`;
  reportContent += `â€¢ Active: ${metrics.sales.active}\n`;
  reportContent += `â€¢ Completed: ${metrics.sales.completed}\n`;
  reportContent += `â€¢ Pending: ${metrics.sales.pending}\n`;
  reportContent += `â€¢ Average Effectiveness: ${metrics.sales.avgEffectiveness.toFixed(1)}%\n`;
  reportContent += `â€¢ Performance Change: ${metrics.sales.change > 0 ? '+' : ''}${metrics.sales.change}%\n\n`;
  
  reportContent += `3.5 DEBT COLLECTION\n\n`;
  reportContent += `â€¢ Total Outstanding: ${metrics.debt.total} accounts\n`;
  reportContent += `â€¢ Total Amount: ${currencySymbol}${metrics.debt.totalAmount.toLocaleString()}\n`;
  reportContent += `â€¢ Overdue Accounts: ${metrics.debt.overdue}\n`;
  reportContent += `â€¢ Overdue Amount: ${currencySymbol}${metrics.debt.overdueAmount.toLocaleString()}\n`;
  reportContent += `â€¢ Collected: ${metrics.debt.collected} accounts\n`;
  reportContent += `â€¢ Collected Amount: ${currencySymbol}${metrics.debt.collectedAmount.toLocaleString()}\n`;
  reportContent += `â€¢ Collection Rate: ${metrics.debt.collectionRate.toFixed(1)}%\n`;
  reportContent += `â€¢ Performance Change: ${metrics.debt.change > 0 ? '+' : ''}${metrics.debt.change}%\n\n`;
  
  reportContent += `3.6 TASK MANAGEMENT\n\n`;
  reportContent += `â€¢ Total Tasks: ${metrics.tasks.total}\n`;
  reportContent += `â€¢ Completed: ${metrics.tasks.completed} (${((metrics.tasks.completed/metrics.tasks.total)*100 || 0).toFixed(1)}%)\n`;
  reportContent += `â€¢ In Progress: ${metrics.tasks.inProgress}\n`;
  reportContent += `â€¢ Pending: ${metrics.tasks.pending}\n`;
  reportContent += `â€¢ Overdue: ${metrics.tasks.overdue} âš ï¸\n`;
  reportContent += `â€¢ Completion Rate: ${metrics.tasks.completionRate.toFixed(1)}%\n`;
  reportContent += `â€¢ Performance Change: ${metrics.tasks.change > 0 ? '+' : ''}${metrics.tasks.change}%\n\n`;
  
  reportContent += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  
  reportContent += `4. AI-DETECTED ISSUES & RISKS\n\n`;
  if (metrics.debt.overdue > 0) {
    reportContent += `âš ï¸ HIGH PRIORITY:\n`;
    reportContent += `â€¢ ${metrics.debt.overdue} overdue debt accounts detected\n`;
    reportContent += `â€¢ Total overdue amount: ${currencySymbol}${metrics.debt.overdueAmount.toLocaleString()}\n\n`;
  }
  if (metrics.kpi.atRisk > 0) {
    reportContent += `âš ï¸ MEDIUM PRIORITY:\n`;
    reportContent += `â€¢ ${metrics.kpi.atRisk} KPIs at risk of not meeting targets\n`;
    reportContent += `â€¢ Immediate action required to get back on track\n\n`;
  }
  if (metrics.competitors.threats > 0) {
    reportContent += `âš ï¸ COMPETITIVE THREAT:\n`;
    reportContent += `â€¢ ${metrics.competitors.threats} high-threat competitors identified\n`;
    reportContent += `â€¢ Market positioning requires strategic review\n\n`;
  }
  if (metrics.afterSales.pending > 0) {
    reportContent += `âš ï¸ OPERATIONAL:\n`;
    reportContent += `â€¢ ${metrics.afterSales.pending} pending after-sales follow-ups\n`;
    reportContent += `â€¢ Customer satisfaction may be impacted\n\n`;
  }
  if (metrics.tasks.overdue > 0) {
    reportContent += `âš ï¸ TASK MANAGEMENT:\n`;
    reportContent += `â€¢ ${metrics.tasks.overdue} overdue tasks requiring immediate attention\n`;
    reportContent += `â€¢ Task completion rate: ${metrics.tasks.completionRate.toFixed(1)}%\n\n`;
  }
  
  reportContent += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  
  reportContent += `5. AI RECOMMENDATIONS\n\n`;
  reportContent += `IMMEDIATE ACTIONS:\n`;
  if (metrics.debt.overdue > 0) {
    reportContent += `â€¢ Prioritize debt collection efforts on ${metrics.debt.overdue} overdue accounts\n`;
    reportContent += `â€¢ Deploy AI agents for automated follow-up via WhatsApp/SMS\n`;
  }
  if (metrics.kpi.atRisk > 0) {
    reportContent += `â€¢ Review ${metrics.kpi.atRisk} at-risk KPIs and adjust strategies\n`;
  }
  if (metrics.afterSales.pending > 0) {
    reportContent += `â€¢ Process ${metrics.afterSales.pending} pending after-sales follow-ups\n`;
  }
  if (metrics.tasks.overdue > 0) {
    reportContent += `â€¢ Address ${metrics.tasks.overdue} overdue tasks immediately - reassign or reprioritize\n`;
  }
  reportContent += `\nSTRATEGIC ACTIONS:\n`;
  reportContent += `â€¢ Continue monitoring competitor movements (${metrics.competitors.tracked} active)\n`;
  reportContent += `â€¢ Optimize sales strategies based on effectiveness data\n`;
  reportContent += `â€¢ Maintain customer satisfaction above ${(metrics.afterSales.avgSatisfaction * 20).toFixed(0)}%\n`;
  reportContent += `â€¢ Improve task completion rate from ${metrics.tasks.completionRate.toFixed(1)}%\n`;
  reportContent += `â€¢ Improve collection rate from ${metrics.debt.collectionRate.toFixed(1)}%\n\n`;
  
  reportContent += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  
  reportContent += `6. NEXT PERIOD FOCUS\n\n`;
  reportContent += `â€¢ Address all high-priority issues identified above\n`;
  reportContent += `â€¢ Monitor KPI progress daily to prevent at-risk items\n`;
  reportContent += `â€¢ Continue competitive intelligence gathering\n`;
  reportContent += `â€¢ Strengthen customer relationship management\n`;
  reportContent += `â€¢ Improve task management completion rate and reduce overdue tasks\n`;
  reportContent += `â€¢ Optimize debt collection processes\n\n`;
  
  reportContent += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\n`;
  reportContent += `Generated by Pocket CRM AI Insight System\n`;
  reportContent += `Report Type: ${config.title}\n`;
  reportContent += `Date: ${date}\n`;
  
  return reportContent;
}
